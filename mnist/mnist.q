/ assume data/ dir w'MNIST files at same level as this script,
/ create dictionary: d of train/test images & labels
/ download from http://yann.lecun.com/exdb/mnist/

mnist:{
 if[null x; x:` sv @[` vs hsym .z.f;1;:;`data]]; / if data dir not given, assume in script dir, i.e. ./data
 x:x{` sv x,`$"-"sv string y}'cross/[(`train`t10k;`images`labels,'`idx3`idx1;`ubyte)];
 `x`y`X`Y!{$[x like"*images*";16_;8_]"h"$read1 x}'[x]}

/check a random digit from training or test data, e.g. showdigit . d`x`y  or showdigit . d`X`Y
showdigit:{show y i:rand count y; -2"* "0=28 28#x til[784]+784*i;}

/define images for standardized digits 0-9 (for labeling, not part of MNIST dataset)
digits:{
 x:10 28 28#0h; c:9+til 9;
 x[0;8 ;c]:0   0   95  199 211 199 95  0   0h  ;
 x[0;9 ;c]:0   113 255 255 255 255 255 113 0h  ;
 x[0;10;c]:29  245 255 130 0   130 255 245 29h ;
 x[0;11;c]:95  255 223 0   0   0   234 255 95h ;
 x[0;12;c]:130 255 212 0   0   0   212 255 130h;
 x[0;13;c]:160 255 212 0   0   0   212 255 160h;
 x[0;14;c]:160 255 212 0   0   0   212 255 160h;
 x[0;15;c]:160 255 212 0   0   0   212 255 160h;
 x[0;16;c]:95  255 212 0   0   0   212 255 95h ;
 x[0;17;c]:76  255 245 29  0   29  245 255 76h ;
 x[0;18;c]:0   212 255 199 144 199 255 212 0h  ;
 x[0;19;c]:0   76  223 255 255 255 223 76  0h  ;
 x[0;20;c]:0   0   29  95  160 95  29  0   0h  ;

 x[1;8 ;c]:0   76  129 159 173 174 0   0   0h  ;
 x[1;9 ;c]:0   212 255 255 255 212 0   0   0h  ;
 x[1;10;c]:0   130 160 212 255 212 0   0   0h  ;
 x[1;11;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;12;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;13;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;14;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;15;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;16;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;17;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;18;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;19;c]:0   0   0   160 255 212 0   0   0h  ;
 x[1;20;c]:0   0   0   54  95  76  0   0   0h  ;

 x[2;8 ;c]:0   0   130 211 211 211 113 0   0h  ;
 x[2;9 ;c]:0   187 255 255 255 255 255 145 0h  ;
 x[2;10;c]:95  255 245 76  0   145 255 245 0h  ;
 x[2;11;c]:160 255 187 0   0   0   255 255 76h ;
 x[2;12;c]:54  95  54  0   0   54  255 255 29h ;
 x[2;13;c]:0   0   0   0   0   200 255 187 0h  ;
 x[2;14;c]:0   0   0   0   160 255 245 29  0h  ;
 x[2;15;c]:0   0   0   130 255 255 76  0   0h  ;
 x[2;16;c]:0   0   130 255 255 130 0   0   0h  ;
 x[2;17;c]:0   76  245 255 130 0   0   0   0h  ;
 x[2;18;c]:76  245 255 223 159 159 159 159 95h ;
 x[2;19;c]:160 255 255 255 255 255 255 255 160h;
 x[2;20;c]:54  95  95  95  95  95  95  95  54h ;

 x[3;8 ;c]:0   0   130 211 211 199 95  0   0h  ;
 x[3;9 ;c]:0   200 255 255 255 255 255 113 0h  ;
 x[3;10;c]:95  255 245 76  0   160 255 234 0h  ;
 x[3;11;c]:145 255 212 0   0   29  255 255 0h  ;
 x[3;12;c]:0   0   0   0   0   95  255 245 0h  ;
 x[3;13;c]:0   0   76  211 211 245 255 130 0h  ;
 x[3;14;c]:0   0   95  255 255 255 245 130 0h  ;
 x[3;15;c]:0   0   0   0   54  145 255 245 29h ;
 x[3;16;c]:54  94  54  0   0   0   255 255 95h ;
 x[3;17;c]:160 255 200 0   0   29  255 255 54h ;
 x[3;18;c]:76  255 255 173 144 211 255 223 0h  ;
 x[3;19;c]:0   130 245 255 255 255 234 76  0h  ;
 x[3;20;c]:0   0   54  113 160 95  0   0   0h  ;

 x[4;8 ;c]:0   0   0   0   0   200 211 130 0h  ;
 x[4;9 ;c]:0   0   0   0   160 255 255 160 0h  ;
 x[4;10;c]:0   0   0   54  255 255 255 160 0h  ;
 x[4;11;c]:0   0   0   212 255 255 255 160 0h  ;
 x[4;12;c]:0   0   145 255 223 212 255 160 0h  ;
 x[4;13;c]:0   29  245 255 76  212 255 160 0h  ;
 x[4;14;c]:0   200 255 174 0   212 255 160 0h  ;
 x[4;15;c]:113 255 245 112 94  223 255 186 94h ;
 x[4;16;c]:234 255 255 255 255 255 255 255 255h;
 x[4;17;c]:212 212 212 212 212 245 255 234 212h;
 x[4;18;c]:0   0   0   0   0   212 255 160 0h  ;
 x[4;19;c]:0   0   0   0   0   212 255 160 0h  ;
 x[4;20;c]:0   0   0   0   0   76  95  54  0h  ;

 x[5;8 ;c]:0   76  211 211 211 211 211 211 0h  ;
 x[5;9 ;c]:0   130 255 255 255 255 255 255 0h  ;
 x[5;10;c]:0   160 255 187 95  95  95  95  0h  ;
 x[5;11;c]:0   174 255 160 0   0   0   0   0h  ;
 x[5;12;c]:0   212 255 199 211 186 113 0   0h  ;
 x[5;13;c]:0   212 255 255 255 255 255 160 0h  ;
 x[5;14;c]:0   245 255 145 95  187 255 255 54h ;
 x[5;15;c]:0   95  95  0   0   0   234 255 113h;
 x[5;16;c]:0   95  94  0   0   0   212 255 160h;
 x[5;17;c]:0   255 255 29  0   0   234 255 95h ;
 x[5;18;c]:0   223 255 211 144 199 255 234 29h ;
 x[5;19;c]:0   76  234 255 255 255 245 95  0h  ;
 x[5;20;c]:0   0   0   95  160 95  29  0   0h  ;

 x[6;8 ;c]:0   0   0   145 199 211 199 113 0h  ;
 x[6;9 ;c]:0   29  211 255 255 255 255 174 0h  ;
 x[6;10;c]:0   160 255 223 54  0   76  54  0h  ;
 x[6;11;c]:0   245 255 95  0   0   0   0   0h  ;
 x[6;12;c]:76  255 255 173 211 211 159 29  0h  ;
 x[6;13;c]:95  255 255 255 255 255 255 223 0h  ;
 x[6;14;c]:95  255 245 95  0   54  234 255 130h;
 x[6;15;c]:95  255 223 0   0   0   160 255 187h;
 x[6;16;c]:76  255 255 0   0   0   160 255 212h;
 x[6;17;c]:0   245 255 95  0   0   200 255 160h;
 x[6;18;c]:0   160 255 245 144 173 255 255 54h ;
 x[6;19;c]:0   29  187 255 255 255 245 130 0h  ;
 x[6;20;c]:0   0   0   76  130 130 54  0   0h  ;

 x[7;8 ;c]:174 211 211 211 211 211 211 211 130h;
 x[7;9 ;c]:212 255 255 255 255 255 255 255 160h;
 x[7;10;c]:76  95  95  95  95  130 255 255 76h ;
 x[7;11;c]:0   0   0   0   0   223 255 145 0h  ;
 x[7;12;c]:0   0   0   0   130 255 212 0   0h  ;
 x[7;13;c]:0   0   0   0   234 255 95  0   0h  ;
 x[7;14;c]:0   0   0   113 255 223 0   0   0h  ;
 x[7;15;c]:0   0   0   187 255 145 0   0   0h  ;
 x[7;16;c]:0   0   0   255 255 76  0   0   0h  ;
 x[7;17;c]:0   0   76  255 255 0   0   0   0h  ;
 x[7;18;c]:0   0   113 255 223 0   0   0   0h  ;
 x[7;19;c]:0   0   160 255 212 0   0   0   0h  ;
 x[7;20;c]:0   0   54  95  76  0   0   0   0h  ;

 x[8;8 ;c]:0   0   113 211 211 211 113 0   0h  ;
 x[8;9 ;c]:0   160 255 255 255 255 255 160 0h  ;
 x[8;10;c]:0   255 255 130 0   145 255 255 0h  ;
 x[8;11;c]:76  255 255 0   0   0   255 255 76h ;
 x[8;12;c]:0   255 255 95  0   95  255 245 0h  ;
 x[8;13;c]:0   130 255 255 211 255 255 130 0h  ;
 x[8;14;c]:0   130 245 255 255 255 245 130 0h  ;
 x[8;15;c]:54  255 255 130 29  145 255 255 54h ;
 x[8;16;c]:160 255 212 0   0   0   212 255 160h;
 x[8;17;c]:145 255 223 0   0   0   223 255 145h;
 x[8;18;c]:54  255 255 186 129 186 255 255 54h ;
 x[8;19;c]:0   130 245 255 255 255 245 130 0h  ;
 x[8;20;c]:0   0   29  113 160 113 29  0   0h  ;

 x[9;8 ;c]:0   0   130 211 211 186 76  0   0h  ;
 x[9;9 ;c]:0   187 255 255 255 255 245 95  0h  ;
 x[9;10;c]:95  255 255 76  0   174 255 234 0h  ;
 x[9;11;c]:160 255 187 0   0   29  255 255 54h ;
 x[9;12;c]:200 255 160 0   0   0   234 255 95h ;
 x[9;13;c]:160 255 211 0   0   0   223 255 95h ;
 x[9;14;c]:54  255 255 173 112 199 255 255 95h ;
 x[9;15;c]:0   130 255 255 255 255 255 255 95h ;
 x[9;16;c]:0   0   54  130 160 76  255 255 76h ;
 x[9;17;c]:0   0   0   0   0   95  255 255 0h  ;
 x[9;18;c]:0   130 173 129 159 245 255 160 0h  ;
 x[9;19;c]:0   187 255 255 255 255 187 29  0h  ;
 x[9;20;c]:0   0   113 160 130 76  0   0   0h  ;

 x}
